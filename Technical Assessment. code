---Code made it in snowflake

---Remove duplicates
CREATE TABLE REMOVE_DUPLICATES AS
SELECT DISTINCT * FROM TRANSACTIONS

---Fill null values found on the columns
UPDATE REMOVE_DUPLICATES
SET PRODUCT_NAME= COALESCE(RPODUCT_NAME, 0)
WHERE PRODUCT_NAME IS NULL
---Same code for client_name and store_name

---Remove invalid characters
SELECT DISTINCT REGEXP_SUBSTR(discount, '[^a-zA-Z0-9_@.]', 1, 1) AS invalid_characters
FROM REMOVE_DUPLICATES
---Same code for all columns

---Create a Client table
CREATE TABLE Client_table AS 
SELECT CLIENT_ID
,CLIENT_NAME
,CLIENT_LASTNAME
,EMAIL
FROM REMOVE_DUPLICATES
ORDER BY CLIENT_ID

---Create a Store table
CREATE TABLE Store_table AS 
SELECT STORE_ID
,STORE_NAME
,LOCATION
FROM REMOVE_DUPLICATES
ORDER BY STORE_ID

---Create a Product table
CREATE TABLE  Product_table AS 
SELECT PRODUCT_ID
,PRODUCT_NAME
,CATEGORY
,BRAND
FROM REMOVE_DUPLICATES

---Create an Address table
CREATE TABLE Adress_table AS 
SELECT ADDRESS_ID
,STREET
,CITY
,STATE
,ZIP_CODE
FROM REMOVE_DUPLICATES
ORDER BY ADDRESS_ID

---Create a Sales fact table
 CREATE TABLE Sales_fact_table AS 
 SELECT CLIENT_ID
 ,STORE_ID
 ,PRODUCT_ID
 ,ADDRESS_ID
 ,TRANSACTION_ID
 ,QUANTITY_OF_ITEMS_SOLD
 ,UNIT_PRICE
 ,DISCOUNT
 FROM REMOVE_DUPLICATES
 ORDER BY CLIENT_ID




